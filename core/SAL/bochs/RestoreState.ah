#ifndef __RESTORE_STATE_AH__
  #define __RESTORE_STATE_AH__

#include <iostream>

#include "config/FailConfig.hpp"
#include "../SALInst.hpp"

#ifdef CONFIG_SR_RESTORE

#include "bochs.h"

aspect RestoreState {
	pointcut restoreState()  = "void bx_sr_after_restore_state()";

	advice execution (restoreState()) : after ()
	{
		std::cout << "[FAIL] Restore finished" << std::endl;
		// TODO: Log-Level?
		fail::simulator.restoreDone();
	}
};

#endif // CONFIG_SR_RESTORE

#endif // __RESTORE_STATE_AH__
