#ifndef __RESTORE_AH__
  #define __RESTORE_AH__

#include <iostream>
#include "config/FailConfig.hpp"
#include "../SALInst.hpp"

#ifdef CONFIG_SR_RESTORE

#include "bochs.h"

aspect restore {
	pointcut restoreState()  = "void bx_sr_after_restore_state()";

	advice execution (restoreState()) : after () {
		std::cout << "[FAIL] Restore finished" << std::endl;
		sal::simulator.restoreDone();
	}
};

#endif // CONFIG_SR_RESTORE

#endif // __RESTORE_AH__
